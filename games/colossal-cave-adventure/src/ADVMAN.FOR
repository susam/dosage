C  ADVENTURE MAIN PROGRAM
      SUBROUTINE MAINP
C ADVENTURES
C
C MODIFIED BY KENT BLACKETT
C             ENGINEERING SYSTEMS GROUP
C             DIGITAL EQUIPMENT CORP.
C             15-JUL-77
C ORIGINAL VERSION WAS FOR DECSYSTEM-10
C THIS VERSION IS FOR FORTRAN IV-PLUS UNDER
C THE IAS OPERATING SYSTEM ON THE PDP-11/70
C NOTE THAT IT MUST BE COMPILED WITH THE
C /WF:3/I4 SWITCHES...
C
C
C  CURRENT LIMITS
C       750 TRAVEL OPTIONS (TRAVEL, TRVSIZ).
C       300 VOCABULARY WORDS (KTAB, ATAB, TABSIZ).
C       150 LOCATIONS (LTEXT, STEXT, KEY, COND, ABB, ATLOC, LOCSIZ)
C       100 OBJECTS (PLAC, PLACE, FIXD, FIXED, LINK (TWICE), PTEXT, PROP).
C        35 "ACTION" VERBS (ACTSPK, VRBSIZ).
C       205 RANDOM MESSAGES (RTEXT, TRXSIZ).
C        12 DIFFERENT PLAYER CLASSIFICATIONS (CTEXT, CVAL, CLSMAX).
C        20 HINTS, LESS 3 (HINTLC, HINTED, HINTS, HNTSIZ).
C        35 MAGIC MESSAGES (MTEXT, MAGSIZ).
C  THERE ARE ALSO LIMITS WHICH CANNOT BE EXCEEDED DUE TO THE STRUCTURE OF
C  THE DATABASE.  (E.G., THE VOCABULARY USES N/1000 TO DETERMINE WORD TYPE,
C  SO THERE CAN'T BE MORE THAN 1000 WORDS.)  THESE UPPER LIMITS ARE:
C       1000 NON-SYNONYMOUS VOCABULARY WORDS
C        300 LOCATIONS
C        100 OBJECTS
C
C  INCLUDE DEFINED COMMONS
      INCLUDE 'ADVCOM.COM'
      INCLUDE 'NEWCOM.COM'
C
C
      INCLUDE 'FUNCT.H'
      INCLUDE 'DATAB.H'
      
C  START-UP, DWARF STUFF

    1 DEMO=START(0)
      CALL MOTD(.FALSE.)
      I=RAN(0)
      HINTED(3)=YES(65,1,0)
      NEWLOC=1
      LOC=NEWLOC
      SETUP=3
      LIMIT=330
      IF(HINTED(3)) LIMIT=1000
     
C  CAN'T LEAVE CAVE ONCE IT'S CLOSING (EXCEPT BY MAIN OFFICE).
    2 CONTINUE
      CALL DWARFS(IRET)
C
C  NOW CALL MAIN PROCESSING
      CALL SEARCH(IRET)
C
C  UPON RETURN, CHECK FOR EXIT OR CONTINUE
      GOTO (2,25000,26000), IRET
C
C  EXIT REQUESTED.  THE ADVENTURE IS OVER.
25000 CONTINUE
      RETURN
C
C  MAINTENANCE MODE REQUESTED.  CALL MAINT
26000 CALL MAINT
      GOTO 2
      END
      