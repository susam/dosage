      SUBROUTINE SPEAK(N)
      
C  PRINT THE MESSAGE IN RECORD N OF THE RANDOM ACCESS MESSAGE FILE.
C  PRECEDE IT WITH A BLANK LINE UNLESS BLKLIN IS FALSE.

      IMPLICIT INTEGER*4 (A-Z)
C     INTEGER*2 RTEXT,ASCVAR,N
      LOGICAL BLKLIN
      COMMON /TXTCOM/ RTEXT,LINES,ASCVAR
      COMMON /BLKCOM/ BLKLIN
      DIMENSION RTEXT(205),LINES(18)
      
      IF(N.EQ.0) RETURN
      READ(2,REC=N) LOC,LINES
      ASCVAR=N+1
      IF(LINES(1).EQ.'>$<') RETURN
      IF(BLKLIN) WRITE(*,2)
    1 OLDLOC=LOC
      DO 3 I=18,1,-1
      L=I
      IF(LINES(I).NE.' ') GOTO 5
    3 CONTINUE
    5 WRITE(*,2) (LINES(I),I=1,L)
    2 FORMAT(' ',18A4)
      READ(2,REC=ASCVAR) LOC,LINES
      ASCVAR=ASCVAR+1
      IF(LOC.EQ.OLDLOC) GOTO 1
      RETURN
      END
