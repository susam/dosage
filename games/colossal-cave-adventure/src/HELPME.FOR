      SUBROUTINE HELPME
C
      INCLUDE 'ADVCOM.COM'
      INCLUDE 'NEWCOM.COM'
      INCLUDE 'FUNCT.H'
      
C
C  CHECK IF THIS LOC IS ELIGIBLE FOR ANY HINTS.  IF BEEN HERE LONG ENOUGH,
C  BRANCH TO HELP SECTION (ON LATER PAGE).  HINTS ALL COME BACK HERE EVENTUALLY
C  TO FINISH THE LOOP.  IGNORE "HINTS" < 4 (SPECIAL STUFF, SEE DATABASE NOTES).

 2600 DO 2602 HINT=4,HNTMAX
      IF(HINTED(HINT)) GOTO 2602
      IF(.NOT.BITSET(LOC,HINT)) HINTLC(HINT)=-1
      HINTLC(HINT)=HINTLC(HINT)+1
      IF(HINTLC(HINT).LT.HINTS(HINT,1)) GOTO 2602
      
C  HINTS
C
C  COME HERE IF HE'S BEEN LONG ENOUGH AT REQUIRED LOC(S) FOR SOME UNUSED HINT.
C  HINT NUMBER IS IN VARIABLE "HINT".  BRANCH TO QUICK TEST FOR ADDITIONAL
C  CONDITIONS, THEN COME BACK TO NEAT STUFF.  GOTO 40010 IF CONDITIONS ARE
C  MET AND WE WANT TO OFFER THE HINT.  GOTO 40020 TO CLEAR HINTLC BACK TO ZERO,
C  40030 TO TAKE NO ACTION YET.

40000 GOTO(40400,40500,40600,40700,40800,40900) (HINT-3)
C           CAVE  BIRD SNAKE  MAZE  DARK  WITT
      CALL BUG(27)
      
40010 HINTLC(HINT)=0
      IF(.NOT.YES(HINTS(HINT,3),0,54)) GOTO 2602
      WRITE(*,40012) HINTS(HINT,2)
40012 FORMAT(/' I AM PREPARED TO GIVE YOU A HINT, BUT IT WILL COST YOU',
     1        I2,' POINTS.')
      HINTED(HINT)=YES(175,HINTS(HINT,4),54)
      IF(HINTED(HINT).AND.LIMIT.GT.30) LIMIT=LIMIT+30*HINTS(HINT,2)
40020 HINTLC(HINT)=0
40030 GOTO 2602

C  NOW FOR THE QUICK TEST.  SEE DATABASE DESCRIPTION FOR ONE-LINE NOTES.

40400 IF(PROP(GRATE).EQ.0.AND..NOT.HERE(KEYS)) GOTO 40010
      GOTO 40020
      
40500 IF(HERE(BIRD).AND.TOTING(ROD).AND.OBJ.EQ.BIRD) GOTO 40010
      GOTO 40030
      
40600 IF(HERE(SNAKE).AND..NOT.HERE(BIRD)) GOTO 40010
      GOTO 40020
      
40700 IF(ATLOC(LOC).EQ.0.AND.ATLOC(OLDLOC).EQ.0
     1   .AND.ATLOC(OLDLC2).EQ.0.AND.HOLDNG.GT.1) GOTO 40010
      GOTO 40020
      
40800 IF(PROP(EMRALD).NE.-1.AND.PROP(PYRAM).EQ.-1) GOTO 40010
      GOTO 40020
      
40900 GOTO 40010

 2602 CONTINUE
      RETURN
      END
